{"version":3,"sources":["Player.js"],"names":["cc","Class","extends","Component","properties","jumpHeight","jumpDuration","maxMoveSpeed","accel","onLoad","jumpAction","runJumpAction","tween","node","then","start","accLeft","accRight","xSpeed","systemEvent","on","SystemEvent","EventType","KEY_DOWN","onKeyDown","KEY_UP","onKeyUp","onDestoryKey","off","jumpUp","by","y","easing","jumpDown","sequence","repeatForever","event","keyCode","macro","KEY","a","d","update","dt","Math","abs","x"],"mappings":"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","file":"Player.js","sourceRoot":"../../../../assets/script","sourcesContent":["\ncc.Class({\n    extends: cc.Component,\n\n    properties: {\n        jumpHeight: 0,\n        jumpDuration: 0,\n        maxMoveSpeed: 0,\n        accel: 0,\n    },\n\n    \n\n    onLoad: function(){\n        var jumpAction = this.runJumpAction();\n        cc.tween(this.node).then(jumpAction).start();\n\n        this.accLeft = false;//还没激活向左边的加速度\n        this.accRight = false;\n\n        this.xSpeed = 0;  //水平速度为0\n\n        //初始化键盘输入监听\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        cc.systemEvent.on(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);  \n    },\n\n    onDestoryKey () {\n        //取消键盘监听事件\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN, this.onKeyDown, this);\n        cc.systemEvent.off(cc.SystemEvent.EventType.KEY_UP, this.onKeyUp, this);\n    },\n\n    runJumpAction () {\n        var jumpUp = cc.tween().by(this.jumpDuration, {y: this.jumpHeight}, {easing: 'sineOut'});\n        // 下落\n        var jumpDown = cc.tween().by(this.jumpDuration, {y: -this.jumpHeight}, {easing: 'sineIn'});\n\n        // 创建一个缓动，按 jumpUp、jumpDown 的顺序执行动作\n        var tween = cc.tween().sequence(jumpUp, jumpDown);\n        // 不断重复\n        return cc.tween().repeatForever(tween);\n    },\n\n    onKeyDown (event) {\n        switch(event.keyCode) {\n            case cc.macro.KEY.a:\n                this.accLeft = true;\n                break;\n            case cc.macro.KEY.d:\n                this.accRight = true;\n                break;\n        }\n    },   \n    \n    onKeyUp (event) {\n        switch(event.keyCode) {\n            case cc.macro.KEY.a:\n                this.accLeft = false;\n                break;\n            case cc.macro.KEY.d:\n                this.accRight = false;\n                break;\n        }\n    },\n\n    start () {\n\n    },\n\n    update: function(dt) {\n        if (this.accLeft) {\n            this.xSpeed -= this.accel * dt;\n        }\n        else if (this.accRight) {\n            this.xSpeed += this.accel * dt;\n        }\n\n        if (Math.abs(this.xSpeed) > this.maxMoveSpeed) {\n            this.xSpeed = this.maxMoveSpeed * this.xSpeed / Math.abs(this.xSpeed);\n        }\n\n        this.node.x += this.xSpeed * dt;\n    }\n});\n"]}